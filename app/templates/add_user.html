{% extends "base.html" %}

{% block title %}Add User - Desktop Manager{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 0 auto;">
    <h2>Add New User</h2>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <div class="message error">
        {% for message in messages %}
        <p>{{ message }}</p>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <form method="post" action="{{ url_for('add_user') }}" id="user-form">
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" required>
        </div>

        <div class="form-group">
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>
        </div>

        <div class="form-group">
            <label for="confirm_password">Confirm Password:</label>
            <input type="password" id="confirm_password" name="confirm_password" required>
        </div>

        <div class="form-group">
            <label>
                <input type="checkbox" name="is_admin" value="true">
                Admin User
            </label>
        </div>

        <div id="loading" style="display: none;">
            <div class="loading-wave">
                <div class="loading-bar"></div>
                <div class="loading-bar"></div>
                <div class="loading-bar"></div>
                <div class="loading-bar"></div>
            </div>
        </div>

        <div style="margin-top: 2rem; text-align: center;">
            <button type="submit" class="button" id="submit-btn">Add User</button>
            <a href="{{ url_for('view_users') }}" class="button" style="margin-left: 1rem; background-color: #95a5a6;">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('user-form').addEventListener('submit', function(e) {
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('confirm_password').value;

    if (password !== confirmPassword) {
        e.preventDefault();
        alert('Passwords do not match!');
        return;
    }

    document.getElementById('loading').style.display = 'block';
    document.getElementById('submit-btn').style.display = 'none';
});
</script>
{% endblock %}
